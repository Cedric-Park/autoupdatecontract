# 🎮 게임더하기 계약 관리 자동화 시스템

게임더하기 계약 정보를 자동으로 크롤링하고 구글 시트에 업데이트하며, 변경사항을 실시간으로 알림 발송하는 완전 자동화 시스템입니다.

## ✨ 주요 기능

### 🔄 **자동화 기능**
- **자동 크롤링**: 게임더하기 관리자 페이지에서 계약 정보 자동 수집
- **실시간 감지**: 신규 계약 및 변경사항 실시간 감지
- **구글 시트 연동**: 자동으로 데이터 업데이트 및 동기화
- **최종계약체결 자동화**: K,L,M,N열에 계약 상세 정보 자동 입력

### 🔔 **알림 시스템**
- **담당자 개별 이메일**: 게임사별 담당자에게 맞춤 알림
- **관리자 텔레그램**: 모든 변경사항 실시간 관리자 알림
- **견적서 상세 정보**: 변경 알림에 견적 업체, 금액, 날짜 포함
- **게임사별 맞춤 제목**: 자동 생성되는 이메일 제목

### 🖥️ **GUI 관리 대시보드**
- **실행 상태 모니터링**: 🟢 실행 중 / 🔴 중지됨 실시간 표시
- **수동 제어**: 즉시 실행, 시작, 중지 버튼
- **실행 주기 설정**: 15분~3시간 드롭다운 선택
- **실시간 통계**: 성공/실패 횟수, 다음 실행 카운트다운
- **실행 로그**: 모든 작업 내역 실시간 표시

## 🚀 빠른 시작

### 1. 의존성 설치
```bash
# 더블클릭으로 실행하거나
install_dependencies.bat

# 또는 수동으로 설치
pip install -r requirements.txt
```

### 2. 환경 변수 설정
다음 환경 변수들을 설정해주세요:

```bash
# 이메일 발송 (Gmail 앱 패스워드 필요)
EMAIL_SENDER=your-email@gmail.com
EMAIL_APP_PASSWORD=your-app-password
ADMIN_EMAIL=admin@company.com

# 텔레그램 알림
TELEGRAM_BOT_TOKEN=your-bot-token
TELEGRAM_CHAT_ID=your-chat-id
```

### 3. 구글 서비스 계정 설정
1. Google Cloud Console에서 서비스 계정 생성
2. JSON 키 파일을 `google_service_account.json`으로 저장
3. 구글 시트에 서비스 계정 이메일 편집 권한 부여

### 4. 실행 방법

#### GUI 대시보드 (권장)
```bash
start_dashboard.bat  # 더블클릭
```

#### 1회 실행
```bash
run_automation.bat  # 더블클릭
# 또는
python login_and_crawl.py
```

## 🎯 사용법

### GUI 대시보드 사용법

1. **`start_dashboard.bat`** 더블클릭으로 대시보드 실행
2. **실행 주기 설정** (15분/30분/1시간/2시간/3시간)
3. **💾 설정 저장** 버튼 클릭
4. **▶️ 자동 실행 시작** 버튼 클릭
5. 실시간으로 상태 모니터링 및 로그 확인

### 수동 제어
- **🚀 즉시 실행**: 주기와 관계없이 바로 크롤링 시작
- **⏹️ 자동 실행 중지**: 스케줄러 중지
- **카운트다운**: 다음 실행까지 실시간 카운트다운 표시

## 📊 알림 시나리오

### 신규 계약 등록
- **담당자 있는 게임사**: 개별 이메일 + 관리자 텔레그램
- **담당자 없는 게임사**: 관리자 텔레그램만
- **이메일 제목**: `[게임더하기] 게임사명 - 신규 계약 업데이트 알림`

### 변경사항 알림
- **견적서 건수 변경**: J열 견적서 상세 정보 포함
- **진행상황 변경**: 단계별 상태 변화 알림
- **최종계약체결**: K,L,M,N열 계약 상세 정보 자동 업데이트

### 알림 내용 예시
```
🔔 [넥셀론] 계약 정보 변경

박종철님, 게임사 [넥셀론]의 '<What Duck: Defense> 타겟 국가 UA 마케팅' 계약 정보가 변경되었습니다.

📅 입찰 마감일: 2025-05-24
🔄 진행상황: 견적서 제출

변경된 항목:
- 견적서 제출 건: 0건 → 1건
- 진행상황: 견적요청 → 견적서 제출

📋 제출된 견적서 상세 내용:
1) ✔ 2025-05-23 | 주식회사 마케팅파트너스 - 견적등록 (₩15,000,000)
```

## 📁 파일 구조

```
auto_update_contract/
├── 📄 메인 프로그램
│   ├── login_and_crawl.py       # 메인 실행 파일
│   ├── dashboard.py             # GUI 관리 대시보드
│   └── scheduler_with_gui.py    # 기존 스케줄러 (사용 안함)
├── 🔧 모듈
│   ├── browser_utils.py         # 브라우저/크롤링 관련
│   ├── gsheet_manager.py        # 구글 시트 처리
│   └── notification.py          # 알림 시스템
├── 🔨 실행 파일
│   ├── install_dependencies.bat # 패키지 설치
│   ├── start_dashboard.bat      # GUI 대시보드 실행
│   └── run_automation.bat       # 1회 실행
├── ⚙️ 설정 파일
│   ├── requirements.txt         # 패키지 목록
│   ├── google_service_account.json # 구글 인증 (직접 생성)
│   └── dashboard_config.json    # 대시보드 설정 (자동 생성)
└── 🧪 테스트 도구
    ├── debug_sheet.py           # 구글 시트 상태 확인
    └── test_notification.py     # 알림 테스트
```

## 🛠️ 기술 스택

- **Python 3.8+**: 메인 언어
- **Selenium**: 웹 크롤링
- **tkinter**: GUI 대시보드
- **APScheduler**: 백그라운드 스케줄링
- **gspread**: 구글 시트 연동
- **yagmail**: 이메일 발송
- **requests**: 텔레그램 API

## 📋 체크리스트

현재 **16개 주요 기능 중 15개 완료** (93.75% 완료율)

✅ **완료된 기능들**
- 자동 로그인 및 크롤링
- 구글 시트 연동 및 데이터 정규화
- 담당자별 이메일 발송
- 텔레그램 알림 시스템
- 예외 및 오류 처리
- 자동화 스케줄링
- 견적서 상세 크롤링
- 코드 모듈화 및 유지보수성 개선
- 최종계약체결 자동화
- 알림 시스템 완전 복원 및 고도화
- 품질 보증 및 테스트 도구
- **GUI 관리 대시보드** ← NEW!

## 🆘 문제 해결

### 자주 발생하는 문제

1. **ModuleNotFoundError**
   ```bash
   install_dependencies.bat  # 실행
   ```

2. **구글 시트 연결 실패**
   - `google_service_account.json` 파일 확인
   - 서비스 계정 권한 확인

3. **크롬 드라이버 오류**
   - Chrome 브라우저 최신 버전으로 업데이트
   - `webdriver-manager`가 자동으로 드라이버 관리

4. **대시보드 실행 안됨**
   - Python 버전 확인 (3.8 이상)
   - APScheduler 패키지 설치 확인

## 📞 지원

문제가 발생하면 다음을 확인해주세요:
1. Python 3.8 이상 설치 여부
2. 모든 패키지 설치 완료 여부 (`install_dependencies.bat`)
3. 환경 변수 설정 완료 여부
4. 구글 서비스 계정 설정 완료 여부

---

**개발 완료**: 2025년 5월 24일  
**자동화 수준**: 완전 자동화 (사람 개입 불필요)  
**알림 커버리지**: 100% (모든 변경사항 실시간 감지) 